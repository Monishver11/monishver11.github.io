<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd"> <html><body> <p>Continuing from our discussion of supervised learning, we now dive into <strong>Empirical Risk Minimization (ERM)</strong>. While the ultimate goal is to minimize the true risk, ERM provides a practical way to approximate this goal using finite data. Let’s break it down.</p> <hr> <h3 id="definition-empirical-risk-minimization"><strong>Definition: Empirical Risk Minimization</strong></h3> <p>A function \(\hat{f}\) is an <strong>empirical risk minimizer</strong> if:</p> \[\hat{f} \in \arg\min_f \hat{R}_n(f),\] <p>where \(\hat{R}_n(f)\) is the empirical risk, defined over a finite sample and the minimum is taken over all functions\(f: X \to Y\). In an ideal scenario, we would want to minimize the true risk \(R(f)\). This raises a critical question:</p> <p><strong>Is the empirical risk minimizer close enough to the true risk minimizer?</strong></p> <h4 id="example-of-erm-in-action"><strong>Example of ERM in Action</strong></h4> <p>Let’s consider a simple case:</p> <ul> <li>Let \(P_X = \text{Uniform}[0,1]\) and \(Y \equiv 1\) (i.e., \(Y\) is always 1).</li> <li>A proposed prediction function:</li> </ul> \[\hat{f}(x) = \begin{cases} 1 &amp; \text{if } x \in \{0.25, 0.5, 0.75\}, \\ 0 &amp; \text{otherwise.} \end{cases}\] <p><strong>Loss Analysis</strong></p> <p>Under both the square loss and the 0-1 loss:</p> <ul> <li> <strong>Empirical Risk</strong>: 0</li> <li> <strong>True Risk</strong>: 1</li> </ul> <p><strong>Explanation</strong>: - The <strong>empirical risk</strong> measures the loss on the training data. Since \(\hat{f}(x)\) perfectly predicts the labels for the training points \(x \in \{0.25, 0.5, 0.75\}\), the empirical risk is zero. There are no errors on the observed data points. - The <strong>true risk</strong>, however, measures the loss over the entire distribution of \(P_X\). For all \(x \notin \{0.25, 0.5, 0.75\}\), \(\hat{f}(x)\) incorrectly predicts 0 instead of the correct label 1, resulting in significant errors. Since \(P_X\) is uniform over \([0,1]\), this means \(\hat{f}(x)\) is incorrect for all others data points of the domain, leading to a true risk of 1.</p> <p>This illustrates a key problem: ERM can lead to overfitting by simply memorizing the training data.</p> <hr> <h3 id="generalization-improving-erm"><strong>Generalization: Improving ERM</strong></h3> <p>In the above example, ERM failed to generalize to unseen data. To improve generalization, we must “smooth things out”—a process that spreads and extrapolates information from observed parts of the input space \(X\) to unobserved parts.</p> <p>One solution is <strong>Constrained ERM</strong>: Instead of minimizing empirical risk over all possible functions, we restrict our search to a subset of functions, known as a <strong>hypothesis space</strong>.</p> <h4 id="hypothesis-spaces"><strong>Hypothesis Spaces</strong></h4> <p>A <strong>hypothesis space</strong> \(\mathcal{F}\) is a set of prediction functions mapping \(X \to Y\) that we consider when applying ERM.</p> <p><strong>Desirable Properties of a Hypothesis Space</strong></p> <ul> <li>Includes only functions with the desired “regularity” (e.g., smoothness or simplicity).</li> <li>Is computationally tractable (efficient algorithms exist for finding the best function in \(\mathcal{F}\)).</li> </ul> <p>In practice, much of machine learning involves designing appropriate hypothesis spaces for specific tasks.</p> <h4 id="constrained-erm"><strong>Constrained ERM</strong></h4> <p>Given a hypothesis space \(\mathcal{F}\), the empirical risk minimizer in \(\mathcal{F}\) is defined as:</p> \[\hat{f}_n \in \arg\min_{f \in \mathcal{F}} \frac{1}{n} \sum_{i=1}^n \ell(f(x_i), y_i),\] <p>where \(\ell(f(x), y)\) is the loss function.</p> <p>Similarly, the true risk minimizer in \(\mathcal{F}\) is:</p> \[f^*_{\mathcal{F}} \in \arg\min_{f \in \mathcal{F}} \mathbb{E}[\ell(f(x), y)].\] <hr> <h3 id="excess-risk-decomposition"><strong>Excess Risk Decomposition</strong></h3> <p>We analyze the performance of ERM through <strong>excess risk decomposition</strong>, which breaks down the gap between the true risk(e.g., the function returned by ERM) and the risk of the Bayes optimal function:</p> <p><strong>Definitions</strong></p> <ul> <li> <strong>Bayes Optimal Function</strong>: \(f^* = \arg\min_f \mathbb{E}[\ell(f(x), y)]\).</li> <li> <strong>Risk Minimizer in \(\mathcal{F}\)</strong>: \(f_{\mathcal{F}} = \arg\min_{f \in \mathcal{F}} \mathbb{E}[\ell(f(x), y)]\).</li> <li> <strong>ERM Solution</strong>: \(\hat{f}_n = \arg\min_{f \in \mathcal{F}} \frac{1}{n} \sum_{i=1}^n \ell(f(x_i), y_i)\).</li> </ul> <h4 id="excess-risk-decomposition-for-erm"><strong>Excess Risk Decomposition for ERM</strong></h4> <p><strong>Definition</strong></p> <p>The <strong>excess risk</strong> measures how much worse the risk of a function \(f\) is compared to the risk of the Bayes optimal function \(f^*\), which minimizes the true risk. Mathematically, it is defined as:</p> \[\text{Excess Risk}(f) = R(f) - R(f^*),\] <p>where:</p> <ul> <li>\(R(f)\) is the true risk of the function \(f\).</li> <li>\(R(f^*)\) is the Bayes risk, i.e., the lowest achievable risk.</li> </ul> <p><strong>Can Excess Risk Be Negative?</strong> No, the excess risk can never be negative because the Bayes optimal function \(f^*\) achieves the minimum possible risk by definition. For any other function \(f\), the risk \(R(f)\) will be equal to or greater than \(R(f^*)\).</p> <h5 id="decomposition-of-excess-risk-for-erm"><strong>Decomposition of Excess Risk for ERM</strong></h5> <p>For the empirical risk minimizer \(\hat{f}_n\), the excess risk can be decomposed as follows:</p> \[\text{Excess Risk}(\hat{f}_n) = R(\hat{f}_n) - R(f^*) = \underbrace{R(\hat{f}_n) - R(f_\mathcal{F})}_{\text{Estimation Error}} + \underbrace{R(f_\mathcal{F}) - R(f^*)}_{\text{Approximation Error}},\] <p>where:</p> <ul> <li>\(f_\mathcal{F}\) is the best function within the chosen hypothesis space \(\mathcal{F}\).</li> <li> <strong>Estimation Error</strong>: This term captures the error due to estimating the best function \(f_\mathcal{F}\) using finite training data.</li> <li> <strong>Approximation Error</strong>: This term reflects the penalty for restricting the search to the hypothesis space \(\mathcal{F}\) instead of considering all possible functions.</li> </ul> <p><strong>Key Insight: Tradeoff Between Errors</strong> There is always a <strong>tradeoff</strong> between approximation and estimation errors:</p> <ul> <li>A larger hypothesis space \(\mathcal{F}\) reduces approximation error but increases estimation error (due to greater model complexity).</li> <li>A smaller hypothesis space \(\mathcal{F}\) reduces estimation error but increases approximation error (due to limited flexibility).</li> </ul> <p>This tradeoff is crucial when designing models and choosing hypothesis spaces.</p> <hr> <h3 id="erm-in-practice"><strong>ERM in Practice</strong></h3> <p>In real-world machine learning, finding the exact ERM solution is challenging. We often settle for an approximate solution:</p> <ul> <li>Let \(\tilde{f}_n\) be the function returned by an optimization algorithm.</li> <li>The <strong>optimization error</strong> is:</li> </ul> <p>\(\text{Optimization Error} = R(\tilde{f}_n) - R(\hat{f}_n).\) - where: - \(\tilde{f}_n\)is the function returned by the optimization method. - \(\hat{f}_n\)is the empirical risk minimizer.</p> <h5 id="practical-decomposition"><strong>Practical Decomposition</strong></h5> <p>For \(\tilde{f}_n\), the excess risk can be further decomposed as:</p> \[\text{Excess Risk}(\tilde{f}_n) = \underbrace{R(\tilde{f}_n) - R(\hat{f}_n)}_{\text{Optimization Error}} + \underbrace{R(\hat{f}_n) - R(f_{\mathcal{F}})}_{\text{Estimation Error}} + \underbrace{R(f_{\mathcal{F}}) - R(f^*)}_{\text{Approximation Error}}.\] <hr> <h3 id="summary-erm-overview"><strong>Summary: ERM Overview</strong></h3> <p>To apply ERM in practice:</p> <ol> <li> <strong>Choose a loss function</strong> \(\ell(f(x), y)\).</li> <li> <strong>Define a hypothesis space</strong> \(\mathcal{F}\) that balances approximation and estimation error.</li> <li> <strong>Use an optimization method</strong> to find \(\hat{f}_n = \arg\min_{f \in \mathcal{F}} \frac{1}{n} \sum_{i=1}^n \ell(f(x_i), y_i)\) (or an approximate solution \(\tilde{f}_n\)).</li> </ol> <p>As the size of training data increases, we can use larger hypothesis spaces to reduce approximation error while keeping estimation error manageable.</p> <hr> <h3 id="conclusion"><strong>Conclusion</strong></h3> <p>Empirical Risk Minimization (ERM) provides a foundational framework for supervised learning by optimizing a model’s performance on training data. However, achieving a balance between approximation, estimation, and optimization errors is key to building effective models. This naturally raises the question: <strong>How do we efficiently minimize empirical risk in practice, especially for complex models and large datasets?</strong></p> <p>In the next blog, we’ll dive into <strong>Gradient Descent</strong>, one of the most powerful and widely used optimization algorithms for minimizing risk, and explore how it enables us to tackle the challenges of ERM. Stay tuned!</p> </body></html>